syntax = "proto3";
option java_multiple_files = true;
option java_package = "csstubs";
package csservice; // package do proto

service CSService {
  rpc ProcessImage(stream ImageRequest) returns (ImageIdentifier);

  // Returns the state of the Image
  rpc CheckImageStatus(ImageIdentifier) returns (StatusResponse);

  // Obtains a pre processed Image
  rpc DownloadProcessedImage(ImageIdentifier) returns (stream ImageResponse);
}

message ImageRequest {
  Metadata metadata = 1;
  bytes image_data = 2;
  repeated string keywords = 3;
}

message ImageResponse {
  string image_id = 1;
  Metadata metadata = 2;
  bytes processed_image = 3;
}

message StatusResponse {
  string image_id = 1;
  Status status = 3;
}

message ImageIdentifier {
  string identifier = 1;
}

message ImageStatus {
  Status status = 1;
}

message Metadata {
  string name=1;
  string type=2;
}

enum Status {
  SUCCESS = 0;
  FAILURE = 1;
}


